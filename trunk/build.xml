<?xml version="1.0" encoding="utf-8" ?>
<project name="gwt-links" default="all" basedir=".">

	<property file="build.properties"/>
	<property name="gwt.links.artifactId" value="gwt-links"/>
	<property name="gwt.links.version" value="0.1"/>
	<property name="gwt.links.packaging" value="jar"/>
	<property name="lib.dir"     value="lib"/>
	<property name="gwt.links.artifactFileName" value="${gwt.links.artifactId}-${gwt.links.version}.${gwt.links.packaging}"/>

	<path id="project.class.path">
		<pathelement path="${java.class.path}/"/>
		<pathelement path="${gwt.lib.path}/gwt-user.jar"/>
		<fileset dir="${lib.dir}" includes="**/*.jar"/>
	</path>

	<target name="compile">
		<mkdir dir="target"/>
		<mkdir dir="target/classes"/>
		<javac srcdir="src" destdir="target/classes" includes="**" debug="on" debuglevel="lines,vars,source" source="1.6">
			<classpath refid="project.class.path"/>
		</javac>
	</target>

	<target name="revision">
			<exec dir="." executable="svnversion" failifexecutionfails="false" outputproperty="svn.revision">
				<arg value="."/>
			</exec>
			<property name="svn.revision" value="${svn.revision}"/>
			<echo message="REVISION=${svn.revision}" />
	</target>
	
	<target name="package" depends="compile,revision" description="Package up gwt-links as a jar">
		<tstamp>
		   <format property="build.time" pattern="dd-MM-yyyy HH:mm" />
		</tstamp>
		<jar destfile="target/${gwt.links.artifactFileName}">
			<fileset dir="target/classes">
				<include name="**/*.class" />
			</fileset>
			<fileset dir="src">
				<include name="**" />
			</fileset>
			<manifest>
				<attribute name="Artifact-Id" value="${gwt.links.artifactId}" />
				<attribute name="Artifact-Version" value="${gwt.links.version}" />
				<attribute name="Svn-Revision" value="${svn.revision}" />
				<attribute name="Build-Time" value="${build.time}" />
			</manifest>
		</jar>
	</target>

	<target name="clean">
		<delete dir="target" includeemptydirs="true" />
	</target>

	<target name="all" depends="package"/>

</project>
